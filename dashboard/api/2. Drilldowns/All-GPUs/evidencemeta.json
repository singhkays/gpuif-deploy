{"queries":[{"id":"weekly_listings","compiledQueryString":"SELECT\n    DATE_TRUNC('week', MessageDateTime) as \"week\",\n    \"GPU_Name\",\n    COUNT(DISTINCT MessageID) AS num_listings\nFROM gpu_data.gpu\nGROUP BY \"week\", \"GPU_Name\"\nORDER BY \"week\"","inputQueryString":"SELECT\n    DATE_TRUNC('week', MessageDateTime) as \"week\",\n    \"GPU_Name\",\n    COUNT(DISTINCT MessageID) AS num_listings\nFROM gpu_data.gpu\nGROUP BY \"week\", \"GPU_Name\"\nORDER BY \"week\"","compiled":false,"inline":true},{"id":"gpu_availability_pct","compiledQueryString":"SELECT\n  \"GPU_Name\",\n  COUNT(DISTINCT MessageID) / SUM(COUNT(DISTINCT MessageID)) OVER() AS pct_listings\nFROM gpu_data.gpu\nGROUP BY \"GPU_Name\"\nORDER BY pct_listings DESC","inputQueryString":"SELECT\n  \"GPU_Name\",\n  COUNT(DISTINCT MessageID) / SUM(COUNT(DISTINCT MessageID)) OVER() AS pct_listings\nFROM gpu_data.gpu\nGROUP BY \"GPU_Name\"\nORDER BY pct_listings DESC","compiled":false,"inline":true},{"id":"gpu_availability","compiledQueryString":"SELECT\n  \"GPU_Name\",\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY \"GPU_Name\"\nORDER BY listing_count DESC","inputQueryString":"SELECT\n  \"GPU_Name\",\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY \"GPU_Name\"\nORDER BY listing_count DESC","compiled":false,"inline":true},{"id":"daily_distribution","compiledQueryString":"SELECT\n    \"GPU_Name\",\n    CASE\n        WHEN \"GPU_Name\" LIKE 'RTX%' AND EXTRACT(DOW FROM MessageDateTime) NOT IN (0, 6) THEN 'Nvidia Weekday'\n        WHEN \"GPU_Name\" LIKE 'RTX%' AND EXTRACT(DOW FROM MessageDateTime) IN (0, 6) THEN 'Nvidia Weekend'\n        WHEN \"GPU_Name\" LIKE 'RX%' AND EXTRACT(DOW FROM MessageDateTime) NOT IN (0, 6) THEN 'AMD Weekday'\n        WHEN \"GPU_Name\" LIKE 'RX%' AND EXTRACT(DOW FROM MessageDateTime) IN (0, 6) THEN 'AMD Weekend'\n    END AS series_group,\n    COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY \"GPU_Name\", series_group\nORDER BY \"GPU_Name\", series_group","inputQueryString":"SELECT\n    \"GPU_Name\",\n    CASE\n        WHEN \"GPU_Name\" LIKE 'RTX%' AND EXTRACT(DOW FROM MessageDateTime) NOT IN (0, 6) THEN 'Nvidia Weekday'\n        WHEN \"GPU_Name\" LIKE 'RTX%' AND EXTRACT(DOW FROM MessageDateTime) IN (0, 6) THEN 'Nvidia Weekend'\n        WHEN \"GPU_Name\" LIKE 'RX%' AND EXTRACT(DOW FROM MessageDateTime) NOT IN (0, 6) THEN 'AMD Weekday'\n        WHEN \"GPU_Name\" LIKE 'RX%' AND EXTRACT(DOW FROM MessageDateTime) IN (0, 6) THEN 'AMD Weekend'\n    END AS series_group,\n    COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY \"GPU_Name\", series_group\nORDER BY \"GPU_Name\", series_group","compiled":false,"inline":true},{"id":"weekly_avg_price","compiledQueryString":"SELECT\n    date_trunc('week', MessageDateTime) AS week_start,\n    \"GPU_Name\",\n    AVG(\"Price\") AS average_weekly_price\nFROM gpu_data.gpu\nWHERE Price IS NOT NULL \n  AND Price > 0       \nGROUP BY week_start, \"GPU_Name\"\nORDER BY week_start","inputQueryString":"SELECT\n    date_trunc('week', MessageDateTime) AS week_start,\n    \"GPU_Name\",\n    AVG(\"Price\") AS average_weekly_price\nFROM gpu_data.gpu\nWHERE Price IS NOT NULL \n  AND Price > 0       \nGROUP BY week_start, \"GPU_Name\"\nORDER BY week_start","compiled":false,"inline":true},{"id":"price_distribution","compiledQueryString":"SELECT\n    \"GPU_Name\",\n    MIN(\"Price\") as minV,\n    PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY Price) AS q1_Price,\n    PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY Price) AS med,\n    PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY Price) AS q3_Price,\n    MAX(\"Price\") as maxV\nFROM gpu_data.gpu\nWHERE \"Price\" IS NOT NULL AND \"Price\" > 0\nGROUP BY \"GPU_Name\"\nORDER BY \"GPU_Name\" ASC","inputQueryString":"SELECT\n    \"GPU_Name\",\n    MIN(\"Price\") as minV,\n    PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY Price) AS q1_Price,\n    PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY Price) AS med,\n    PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY Price) AS q3_Price,\n    MAX(\"Price\") as maxV\nFROM gpu_data.gpu\nWHERE \"Price\" IS NOT NULL AND \"Price\" > 0\nGROUP BY \"GPU_Name\"\nORDER BY \"GPU_Name\" ASC","compiled":false,"inline":true},{"id":"msrp_premium_distribution","compiledQueryString":"SELECT\n  \"GPU_Name\",\n  MIN((Price - MSRP) / MSRP) AS min_premium_pct,\n  PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY ((Price - MSRP) / MSRP)) AS q1_premium_pct,\n  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY ((Price - MSRP) / MSRP)) AS median_premium_pct,\n  PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY ((Price - MSRP) / MSRP)) AS q3_premium_pct,\n  MAX((Price - MSRP) / MSRP) AS max_premium_pct\nFROM gpu_data.gpu\nWHERE MSRP IS NOT NULL\n  AND Price IS NOT NULL \n  AND Price > 0       \nGROUP BY \"GPU_Name\"\nORDER BY \"GPU_Name\" ASC","inputQueryString":"SELECT\n  \"GPU_Name\",\n  MIN((Price - MSRP) / MSRP) AS min_premium_pct,\n  PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY ((Price - MSRP) / MSRP)) AS q1_premium_pct,\n  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY ((Price - MSRP) / MSRP)) AS median_premium_pct,\n  PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY ((Price - MSRP) / MSRP)) AS q3_premium_pct,\n  MAX((Price - MSRP) / MSRP) AS max_premium_pct\nFROM gpu_data.gpu\nWHERE MSRP IS NOT NULL\n  AND Price IS NOT NULL \n  AND Price > 0       \nGROUP BY \"GPU_Name\"\nORDER BY \"GPU_Name\" ASC","compiled":false,"inline":true},{"id":"pct_at_or_below_msrp","compiledQueryString":"SELECT\n  \"GPU_Name\",\n  ROUND(\n    COUNT_IF(Price <= MSRP) * 100.0 / NULLIF(COUNT(*), 0),\n    1\n  ) AS pct_at_or_below_msrp\nFROM gpu_data.gpu\nWHERE MSRP IS NOT NULL\n  AND Price IS NOT NULL \n  AND Price > 0       \nGROUP BY \"GPU_Name\"\nORDER BY GPU_Name ASC","inputQueryString":"SELECT\n  \"GPU_Name\",\n  ROUND(\n    COUNT_IF(Price <= MSRP) * 100.0 / NULLIF(COUNT(*), 0),\n    1\n  ) AS pct_at_or_below_msrp\nFROM gpu_data.gpu\nWHERE MSRP IS NOT NULL\n  AND Price IS NOT NULL \n  AND Price > 0       \nGROUP BY \"GPU_Name\"\nORDER BY GPU_Name ASC","compiled":false,"inline":true},{"id":"weekly_price_change","compiledQueryString":"WITH weekly_prices AS (\n  SELECT\n    \"GPU_Name\",\n    DATE_TRUNC('week', MessageDateTime) AS week,\n    AVG(Price) AS avg_price\n  FROM gpu_data.gpu\n  GROUP BY \"GPU_Name\", week\n),\nwith_prev_week AS (\n  SELECT\n    \"GPU_Name\",\n    week,\n    avg_price,\n    LAG(avg_price) OVER (PARTITION BY \"GPU_Name\" ORDER BY week) AS prev_week_price\n  FROM weekly_prices\n)\nSELECT\n  \"GPU_Name\",\n  week,\n  CASE\n    WHEN prev_week_price IS NULL THEN 0\n    ELSE (avg_price / prev_week_price) - 1\n  END AS price_change_pct\nFROM with_prev_week\nWHERE week >= DATE_TRUNC('week', CURRENT_DATE - INTERVAL '3 months')\n  AND Price IS NOT NULL \n  AND Price > 0  \nORDER BY week, \"GPU_Name\"","inputQueryString":"WITH weekly_prices AS (\n  SELECT\n    \"GPU_Name\",\n    DATE_TRUNC('week', MessageDateTime) AS week,\n    AVG(Price) AS avg_price\n  FROM gpu_data.gpu\n  GROUP BY \"GPU_Name\", week\n),\nwith_prev_week AS (\n  SELECT\n    \"GPU_Name\",\n    week,\n    avg_price,\n    LAG(avg_price) OVER (PARTITION BY \"GPU_Name\" ORDER BY week) AS prev_week_price\n  FROM weekly_prices\n)\nSELECT\n  \"GPU_Name\",\n  week,\n  CASE\n    WHEN prev_week_price IS NULL THEN 0\n    ELSE (avg_price / prev_week_price) - 1\n  END AS price_change_pct\nFROM with_prev_week\nWHERE week >= DATE_TRUNC('week', CURRENT_DATE - INTERVAL '3 months')\n  AND Price IS NOT NULL \n  AND Price > 0  \nORDER BY week, \"GPU_Name\"","compiled":false,"inline":true},{"id":"aib_distribution","compiledQueryString":"SELECT\n  \"GPU_Name\",\n  AIB,\n  COUNT(DISTINCT MessageID) AS model_count\nFROM gpu_data.gpu\nGROUP BY \"GPU_Name\", AIB\nORDER BY \"GPU_Name\", model_count DESC","inputQueryString":"SELECT\n  \"GPU_Name\",\n  AIB,\n  COUNT(DISTINCT MessageID) AS model_count\nFROM gpu_data.gpu\nGROUP BY \"GPU_Name\", AIB\nORDER BY \"GPU_Name\", model_count DESC","compiled":false,"inline":true},{"id":"gpu_retailer_heatmap","compiledQueryString":"WITH top10 AS (\n  SELECT Retailer\n  FROM gpu_data.gpu\n  GROUP BY Retailer\n  ORDER BY COUNT(*) DESC\n  LIMIT 10\n)\nSELECT\n  \"GPU_Name\",\n  Retailer,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nWHERE Retailer IN (SELECT Retailer FROM top10)\nGROUP BY \"GPU_Name\", Retailer\nORDER BY \"GPU_Name\", listing_count DESC","inputQueryString":"WITH top10 AS (\n  SELECT Retailer\n  FROM gpu_data.gpu\n  GROUP BY Retailer\n  ORDER BY COUNT(*) DESC\n  LIMIT 10\n)\nSELECT\n  \"GPU_Name\",\n  Retailer,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nWHERE Retailer IN (SELECT Retailer FROM top10)\nGROUP BY \"GPU_Name\", Retailer\nORDER BY \"GPU_Name\", listing_count DESC","compiled":false,"inline":true}]}