{"queries":[{"id":"aib_availability_pct","compiledQueryString":"SELECT\n  AIB,\n  COUNT(DISTINCT MessageID) / SUM(COUNT(DISTINCT MessageID)) OVER() AS pct_listings\nFROM gpu_data.gpu\nGROUP BY AIB\nORDER BY pct_listings DESC","inputQueryString":"SELECT\n  AIB,\n  COUNT(DISTINCT MessageID) / SUM(COUNT(DISTINCT MessageID)) OVER() AS pct_listings\nFROM gpu_data.gpu\nGROUP BY AIB\nORDER BY pct_listings DESC","compiled":false,"inline":true},{"id":"aib_availability","compiledQueryString":"SELECT\n  AIB,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY AIB\nORDER BY listing_count DESC","inputQueryString":"SELECT\n  AIB,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY AIB\nORDER BY listing_count DESC","compiled":false,"inline":true},{"id":"aib_weekly_trend","compiledQueryString":"SELECT \n  DATE_TRUNC('week', MessageDateTime) AS week,\n  AIB,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY week, AIB\nORDER BY week, AIB","inputQueryString":"SELECT \n  DATE_TRUNC('week', MessageDateTime) AS week,\n  AIB,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY week, AIB\nORDER BY week, AIB","compiled":false,"inline":true},{"id":"aib_weekly_trend_relative","compiledQueryString":"SELECT \n  DATE_TRUNC('week', MessageDateTime) AS week,\n  AIB,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY week, AIB\nORDER BY week, AIB","inputQueryString":"SELECT \n  DATE_TRUNC('week', MessageDateTime) AS week,\n  AIB,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nGROUP BY week, AIB\nORDER BY week, AIB","compiled":false,"inline":true},{"id":"aib_gpu_distribution","compiledQueryString":"SELECT \n  AIB,\n  \"GPU_Name\",\n  COUNT(DISTINCT MessageID) AS model_count\nFROM gpu_data.gpu\nGROUP BY AIB, \"GPU_Name\"\nORDER BY AIB, model_count DESC","inputQueryString":"SELECT \n  AIB,\n  \"GPU_Name\",\n  COUNT(DISTINCT MessageID) AS model_count\nFROM gpu_data.gpu\nGROUP BY AIB, \"GPU_Name\"\nORDER BY AIB, model_count DESC","compiled":false,"inline":true},{"id":"aib_manufacturer_mix","compiledQueryString":"SELECT\n  AIB,\n  Manufacturer,\n  COUNT(DISTINCT MessageID) AS cnt\nFROM gpu_data.gpu\nWHERE AIB <> 'NVIDIA'\nGROUP BY AIB, Manufacturer\nORDER BY AIB, manufacturer","inputQueryString":"SELECT\n  AIB,\n  Manufacturer,\n  COUNT(DISTINCT MessageID) AS cnt\nFROM gpu_data.gpu\nWHERE AIB <> 'NVIDIA'\nGROUP BY AIB, Manufacturer\nORDER BY AIB, manufacturer","compiled":false,"inline":true},{"id":"aib_retailer_heatmap_top10","compiledQueryString":"WITH top10 AS (\n  SELECT Retailer\n  FROM gpu_data.gpu\n  GROUP BY Retailer\n  ORDER BY COUNT(*) DESC\n  LIMIT 10\n)\nSELECT\n  AIB,\n  Retailer,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nWHERE Retailer IN (SELECT Retailer FROM top10)\nGROUP BY AIB, Retailer\nORDER BY AIB, listing_count DESC","inputQueryString":"WITH top10 AS (\n  SELECT Retailer\n  FROM gpu_data.gpu\n  GROUP BY Retailer\n  ORDER BY COUNT(*) DESC\n  LIMIT 10\n)\nSELECT\n  AIB,\n  Retailer,\n  COUNT(DISTINCT MessageID) AS listing_count\nFROM gpu_data.gpu\nWHERE Retailer IN (SELECT Retailer FROM top10)\nGROUP BY AIB, Retailer\nORDER BY AIB, listing_count DESC","compiled":false,"inline":true},{"id":"aib_premium_distribution","compiledQueryString":"WITH AibGpuNameAveragePremiums AS (\n  -- Step 1: Calculate average premium for each AIB and GPU_Name combination\n  SELECT\n    AIB,\n    \"GPU_Name\", -- Group by the base GPU name\n    MSRP,       -- MSRP is typically per GPU_Name\n    AVG(((Price - MSRP) / MSRP)) AS average_premium_for_aib_gpu_name -- Changed from PERCENTILE_CONT(0.5) to AVG\n  FROM gpu_data.gpu\n  WHERE MSRP IS NOT NULL\n    AND Price IS NOT NULL\n    AND Price > 0\n    AND MSRP > 0 -- Avoid division by zero or negative MSRP\n  GROUP BY AIB, \"GPU_Name\", MSRP\n)\n-- Step 2: Aggregate these average premiums to the AIB level\nSELECT\n  AIB,\n  MIN(average_premium_for_aib_gpu_name) AS min_premium_pct,\n  PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY average_premium_for_aib_gpu_name) AS q1_premium_pct,\n  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY average_premium_for_aib_gpu_name) AS median_premium_pct, -- Note: This is now the median of the *average* model premiums\n  PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY average_premium_for_aib_gpu_name) AS q3_premium_pct,\n  MAX(average_premium_for_aib_gpu_name) AS max_premium_pct\nFROM AibGpuNameAveragePremiums\nGROUP BY AIB\nORDER BY AIB","inputQueryString":"WITH AibGpuNameAveragePremiums AS (\n  -- Step 1: Calculate average premium for each AIB and GPU_Name combination\n  SELECT\n    AIB,\n    \"GPU_Name\", -- Group by the base GPU name\n    MSRP,       -- MSRP is typically per GPU_Name\n    AVG(((Price - MSRP) / MSRP)) AS average_premium_for_aib_gpu_name -- Changed from PERCENTILE_CONT(0.5) to AVG\n  FROM gpu_data.gpu\n  WHERE MSRP IS NOT NULL\n    AND Price IS NOT NULL\n    AND Price > 0\n    AND MSRP > 0 -- Avoid division by zero or negative MSRP\n  GROUP BY AIB, \"GPU_Name\", MSRP\n)\n-- Step 2: Aggregate these average premiums to the AIB level\nSELECT\n  AIB,\n  MIN(average_premium_for_aib_gpu_name) AS min_premium_pct,\n  PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY average_premium_for_aib_gpu_name) AS q1_premium_pct,\n  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY average_premium_for_aib_gpu_name) AS median_premium_pct, -- Note: This is now the median of the *average* model premiums\n  PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY average_premium_for_aib_gpu_name) AS q3_premium_pct,\n  MAX(average_premium_for_aib_gpu_name) AS max_premium_pct\nFROM AibGpuNameAveragePremiums\nGROUP BY AIB\nORDER BY AIB","compiled":false,"inline":true},{"id":"aib_pct_at_or_below_msrp","compiledQueryString":"SELECT\n  AIB,\n  ROUND(\n    COUNT_IF(Price <= (MSRP + 5)) / NULLIF(COUNT(*), 0), -- -5 to account for $1 difference in listing price and MSRP \n    1\n  ) AS pct_at_or_below_msrp\nFROM gpu_data.gpu\nWHERE MSRP IS NOT NULL\n  AND Price IS NOT NULL\n  AND Price > 0\n  AND MSRP > 0 -- Ensure valid data for calculation\nGROUP BY AIB\nORDER BY pct_at_or_below_msrp DESC","inputQueryString":"SELECT\n  AIB,\n  ROUND(\n    COUNT_IF(Price <= (MSRP + 5)) / NULLIF(COUNT(*), 0), -- -5 to account for $1 difference in listing price and MSRP \n    1\n  ) AS pct_at_or_below_msrp\nFROM gpu_data.gpu\nWHERE MSRP IS NOT NULL\n  AND Price IS NOT NULL\n  AND Price > 0\n  AND MSRP > 0 -- Ensure valid data for calculation\nGROUP BY AIB\nORDER BY pct_at_or_below_msrp DESC","compiled":false,"inline":true},{"id":"aib_price_range","compiledQueryString":"SELECT\n  AIB,\n  MIN(Price) AS min_price,\n  MAX(Price) AS max_price,\n  MEDIAN(Price) AS median_price,\n  QUANTILE_CONT(Price, 0.25) AS q1_price,\n  QUANTILE_CONT(Price, 0.75) AS q3_price\nFROM gpu_data.gpu\nWHERE MSRP IS NOT NULL\n  AND Price IS NOT NULL\n  AND Price > 0\nGROUP BY AIB\nORDER BY AIB ASC","inputQueryString":"SELECT\n  AIB,\n  MIN(Price) AS min_price,\n  MAX(Price) AS max_price,\n  MEDIAN(Price) AS median_price,\n  QUANTILE_CONT(Price, 0.25) AS q1_price,\n  QUANTILE_CONT(Price, 0.75) AS q3_price\nFROM gpu_data.gpu\nWHERE MSRP IS NOT NULL\n  AND Price IS NOT NULL\n  AND Price > 0\nGROUP BY AIB\nORDER BY AIB ASC","compiled":false,"inline":true}]}